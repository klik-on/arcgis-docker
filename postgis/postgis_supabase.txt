docker images supabase
docker pull supabase/studio:2025.07.14-sha-80b9b6f
image: kong:2.8.1
docker pull supabase/gotrue:v2.177.0
image: postgrest/postgrest:v12.0.3 ***
docker pull supabase/realtime:v2.41.6
docker pull supabase/storage-api:v1.25.11
docker pull darthsim/imgproxy:v3.29.1
docker pull supabase/postgres-meta:v0.91.1
docker pull supabase/edge-runtime:v1.68.0
image: supabase/logflare:1.14.2  == 1.15.0 ***
docker pull supabase/postgres:15.8.1.119
docker pull timberio/vector:0.28.1-alpine ***
docker pull supabase/supavisor:2.1.8
###  container_name: supabase-pooler
###  image: supabase/supavisor:2.5.7



# Stop docker and remove volumes:
docker compose down -v

# Remove Postgres data:
rm -rf volumes/db/data/

Install supabase
https://www.digitalocean.com/community/tutorials/how-to-install-and-use-docker-compose-on-ubuntu-22-04
https://www.howtoforge.com/how-to-install-supabase-on-debian-11/
https://supabase.com/docs/guides/self-hosting/docker#dashboard-authentication

Fix
error: git-remote-https died of signal 4
$ sudo GNUTLS_CPUID_OVERRIDE=0x1 apt-get update

you need to add ~/.bashrc with this
$ export  GNUTLS_CPUID_OVERRIDE=0x1
$ git clone --depth 1 https://github.com/supabase/supabase

### Isian .env
https://zeabur.com/templates/YVSAU4

### CEK File  .env
POSTGRES_PASSWORD=password00
JWT_SECRET=1EKfEbmPOw45QHbYKzuZyfbBXUJLx83D1NTEP3sB
ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlzcyI6InN1cGFiYXNlIiwiaWF0IjoxNzUxMzAyODAwLCJleHAiOjE5MDkwNjkyMDB9.5B3KqroqKZUnXyjJg99AtjSjGci-wKqJtH7LWCz7x2U
SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoic2VydmljZV9yb2xlIiwiaXNzIjoic3VwYWJhc2UiLCJpYXQiOjE3NTEzMDI4MDAsImV4cCI6MTkwOTA2OTIwMH0.5Vn4H5dPusgKhVV8ZYP-xOdMNBmirCRR2GDjmoLclGo
DASHBOARD_USERNAME=supabase
DASHBOARD_PASSWORD=password001
SECRET_KEY_BASE=eKGKKRi8eXEs1hGBnfYZhueVqeMisOINDNhy4624ym9pEEhtsqul80NJ0H8Qkrik
VAULT_ENC_KEY=YpDzfO9z11XE8hlE95SleWGHPgyqKlTP

## General
SITE_URL=http://172.16.2.122:3000
ADDITIONAL_REDIRECT_URLS=
JWT_EXPIRY=3600
DISABLE_SIGNUP=false
API_EXTERNAL_URL=http://172.16.2.122:8000

## Email auth
ENABLE_EMAIL_SIGNUP=true
ENABLE_EMAIL_AUTOCONFIRM=false
SMTP_ADMIN_EMAIL=admin@example.com
SMTP_HOST=mail.menlhk.go.id
SMTP_PORT=465
SMTP_USER=webgis@menlhk.go.id
SMTP_PASS=pktl123
SMTP_SENDER_NAME=SupabaseAdmin
ENABLE_ANONYMOUS_USERS=false

# Database - You can change these to any PostgreSQL database that has logical replication enabled.
############

POSTGRES_HOST=db
POSTGRES_DB=postgres
POSTGRES_PORT=5432
# default user is postgres

# Supavisor -- Database pooler
############
# Port Supavisor listens on for transaction pooling connections
POOLER_PROXY_PORT_TRANSACTION=6543
# Maximum number of PostgreSQL connections Supavisor opens per pool
POOLER_DEFAULT_POOL_SIZE=20
# Maximum number of client connections Supavisor accepts per pool
POOLER_MAX_CLIENT_CONN=100
# Unique tenant identifier
POOLER_TENANT_ID=67888 **** username : postgres.67888
# Pool size for internal metadata storage used by Supavisor
# This is separate from client connections and used only by Supavisor itself
POOLER_DB_POOL_SIZE=5

Akses PostgreSQL
host 		: POSTGRES_HOST=db
database 		: POSTGRES_DB=postgres
username 	: POOLER_TENANT_ID=67888 **** username : postgres.67888
password 	:  POSTGRES_PASSWORD=password00
port 		: POSTGRES_PORT=5432


############
# API - Configuration for PostgREST.
############
# Stop docker and remove volumes:
docker compose down -v
# edit .env
PGRST_DB_SCHEMAS=public,storage,graphql_public,datagis
docker compose up -d

## setting waktu
alter database postgres

set timezone to 'Asia/Jakarta';

https://supabase.com/docs/guides/api/using-custom-schemas

CREATE SCHEMA datagis; ==>buat di QGIS
GRANT USAGE ON SCHEMA datagis TO anon, authenticated, service_role;
GRANT ALL ON ALL TABLES IN SCHEMA datagis TO anon, authenticated, service_role;
GRANT ALL ON ALL ROUTINES IN SCHEMA datagis TO anon, authenticated, service_role;
GRANT ALL ON ALL SEQUENCES IN SCHEMA datagis TO anon, authenticated, service_role;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA datagis GRANT ALL ON TABLES TO anon, authenticated, service_role;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA datagis GRANT ALL ON ROUTINES TO anon, authenticated, service_role;
ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA datagis GRANT ALL ON SEQUENCES TO anon, authenticated, service_role;


## Hapus SCHEMA
drop schema datagis;

## Hapus Tabel dalam schema
do $$ declare
         r record;
begin
        for r in (select tablename from pg_tables where schemaname = 'datagis') loop
        execute 'drop table if exists ' || quote_ident(r.tablename) || ' cascade';
    end loop;
end $$;

### Akses SCHEMA
# Append /rest/v1/ to your URL, and then use the table name as the route.

# for GET or HEAD request use Accept-Profile
curl '<SUPABASE_URL>/rest/v1/todos' \
  -H "apikey: <SUPABASE_ANON_KEY>" \
  -H "Authorization: Bearer <SUPABASE_ANON_KEY>" \
  -H "Accept-Profile: myschema"

# for POST, PATCH, PUT and DELETE Request use Content-Profile
curl -X POST '<SUPABASE_URL>/rest/v1/todos' \
  -H "apikey: <SUPABASE_ANON_KEY>" \
  -H "Authorization: Bearer <SUPABASE_ANON_KEY>" \
  -H "Content-Type: application/json" \
  -H "Content-Profile: myschema" \
  -d '{"column_name": "value"}'


curl '172.16.2.122:8000/rest/v1/RUMPIN' \
  -H "apikey: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlzcyI6InN1cGFiYXNlIiwiaWF0IjoxNzUxMzAyODAwLCJleHAiOjE5MDkwNjkyMDB9.5B3KqroqKZUnXyjJg99AtjSjGci-wKqJtH7LWCz7x2U" \
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlzcyI6InN1cGFiYXNlIiwiaWF0IjoxNzUxMzAyODAwLCJleHAiOjE5MDkwNjkyMDB9.5B3KqroqKZUnXyjJg99AtjSjGci-wKqJtH7LWCz7x2U" \
  -H "Accept-Profile: public"


curl '172.16.2.122:8000/rest/v1/RUMPIN2' \
  -H "apikey: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlzcyI6InN1cGFiYXNlIiwiaWF0IjoxNzUxMzAyODAwLCJleHAiOjE5MDkwNjkyMDB9.5B3KqroqKZUnXyjJg99AtjSjGci-wKqJtH7LWCz7x2U" \
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlzcyI6InN1cGFiYXNlIiwiaWF0IjoxNzUxMzAyODAwLCJleHAiOjE5MDkwNjkyMDB9.5B3KqroqKZUnXyjJg99AtjSjGci-wKqJtH7LWCz7x2U" \
  -H "Accept-Profile: datagis"

curl '172.16.2.122:8000/rest/v1/UKL_UPL_AR_50K' \
  -H "apikey: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlzcyI6InN1cGFiYXNlIiwiaWF0IjoxNzUxMzAyODAwLCJleHAiOjE5MDkwNjkyMDB9.5B3KqroqKZUnXyjJg99AtjSjGci-wKqJtH7LWCz7x2U" \
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlzcyI6InN1cGFiYXNlIiwiaWF0IjoxNzUxMzAyODAwLCJleHAiOjE5MDkwNjkyMDB9.5B3KqroqKZUnXyjJg99AtjSjGci-wKqJtH7LWCz7x2U" \
  -H "Accept-Profile: datagis"

curl '172.16.2.122:8000/rest/v1/INDIKATIF_PPTPKH_REVISI_II' \
  -H "apikey: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlzcyI6InN1cGFiYXNlIiwiaWF0IjoxNzUxMzAyODAwLCJleHAiOjE5MDkwNjkyMDB9.5B3KqroqKZUnXyjJg99AtjSjGci-wKqJtH7LWCz7x2U" \
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlzcyI6InN1cGFiYXNlIiwiaWF0IjoxNzUxMzAyODAwLCJleHAiOjE5MDkwNjkyMDB9.5B3KqroqKZUnXyjJg99AtjSjGci-wKqJtH7LWCz7x2U" \
  -H "Accept-Profile: datagis"
